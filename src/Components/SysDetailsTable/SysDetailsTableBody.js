import React from 'react';
import { DetailsTableRow } from '../TableComponents/DetailsTableRow';

export const SysDetailsTableBody = ({
  columns,
  data,
  expandedRows,
  fetchDetailsTable,
  hasWriteAccess,
  isWriteAccessLoading,
  setExpandedRows,
  setSelectedMatches,
  sysMatchStatusFilter,
}) => {
  const hostId = data?.id;
  return data?.affectedRulesList?.map((host, rowIndex) => (
    <DetailsTableRow
      key={rowIndex}
      columns={columns}
      expandedRows={expandedRows}
      fetchDetailsTable={fetchDetailsTable}
      hasWriteAccess={hasWriteAccess}
      host={host}
      hostId={hostId}
      isWriteAccessLoading={isWriteAccessLoading}
      matchStatusFilter={sysMatchStatusFilter}
      rowIndex={rowIndex}
      ruleName={host.name}
      setExpandedRows={setExpandedRows}
      setSelectedMatches={setSelectedMatches}
    />
  ));
};
