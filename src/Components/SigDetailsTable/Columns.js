import React from 'react';
import messages from '../../Messages';
import InsightsLink from '@redhat-cloud-services/frontend-components/InsightsLink';
import { DateFormat } from '@redhat-cloud-services/frontend-components';
import { Icon } from '@patternfly/react-core';
import { BellIcon } from '@patternfly/react-icons';

export const sigDetailsTableColumns = (isWorkspaceEnabled, intl) => [
  {
    title: intl.formatMessage(messages.name),
    width: 35,
    sort: 1,
    renderFunc: (host) => (
      <InsightsLink to={`/systems/${host.id}`}>{host.displayName}</InsightsLink>
    ),
  },
  {
    title: isWorkspaceEnabled
      ? 'Workspace'
      : intl.formatMessage(messages.group),
    width: 10,
    sort: 2,
    renderFunc: (host) =>
      host.groups?.[0]?.name || intl.formatMessage(messages.notApplicable),
  },
  {
    title: intl.formatMessage(messages.os),
    width: 10,
    sort: 3,
    renderFunc: (host) => `RHEL ${host.osVersion}`,
  },
  {
    title: intl.formatMessage(messages.lastMatched),
    width: 15,
    sort: 4,
    renderFunc: (host) => (
      <DateFormat
        date={new Date(host.matches[host.matches.length - 1].scanDate)}
        type="onlyDate"
      />
    ),
  },
  {
    title: intl.formatMessage(messages.newMatchCount),
    width: 15,
    sort: 5,
    renderFunc: (host) => (
      <span>
        {host.newMatchCount > 0 ? (
          <span>
            <Icon
              data-testid="new-matches-bell-icon"
              status="info"
              style={{ marginRight: '8px' }}
            >
              <BellIcon />
            </Icon>
            {host.newMatchCount?.toLocaleString()}
          </span>
        ) : (
          <span className="pf-v5-u-disabled-color-200">
            {host.newMatchCount?.toLocaleString()}
          </span>
        )}
      </span>
    ),
  },
  {
    title: intl.formatMessage(messages.totalMatches),
    width: 15,
    sort: 6,
    renderFunc: (host) => host.matchCount?.toLocaleString(),
  },
];
