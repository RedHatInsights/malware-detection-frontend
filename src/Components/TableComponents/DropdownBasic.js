import React, { useState } from 'react';
import {
  Dropdown,
  DropdownItem,
  DropdownList,
  MenuToggle,
} from '@patternfly/react-core';
import PropTypes from 'prop-types';

export const DropdownBasic = ({
  dropdownValue,
  dropdownValues,
  hasWriteAccess,
  isWriteAccessLoading,
  onChange,
  setDropdownValue,
}) => {
  const [isOpen, setIsOpen] = useState(false);

  const onToggleClick = () => {
    setIsOpen(!isOpen);
  };

  const onSelect = (_event, value) => {
    onChange(value, setDropdownValue);
    setIsOpen(false);
  };

  return (
    <Dropdown
      isOpen={isOpen}
      onSelect={onSelect}
      onOpenChange={(isOpen) => setIsOpen(isOpen)}
      toggle={(toggleRef) => (
        <MenuToggle
          aria-label={'MenuToggle'}
          style={{ maxWidth: '75%' }}
          ref={toggleRef}
          onClick={onToggleClick}
          isDisabled={!isWriteAccessLoading && !hasWriteAccess}
          isExpanded={isOpen}
        >
          {dropdownValues.find((item) => item.value === dropdownValue)?.label}
        </MenuToggle>
      )}
      ouiaId="BasicDropdown"
    >
      <DropdownList>
        {dropdownValues.map((filterValue) => (
          <DropdownItem
            aria-label={`${filterValue.label}`}
            key={filterValue.value}
            component="button"
            onClick={(event) => onSelect(event, filterValue.value)}
          >
            {filterValue.label}
          </DropdownItem>
        ))}
      </DropdownList>
    </Dropdown>
  );
};

DropdownBasic.propTypes = {
  dropdownValue: PropTypes.string,
  dropdownValues: PropTypes.array,
  hasWriteAccess: PropTypes.bool,
  isWriteAccessLoading: PropTypes.bool,
  onChange: PropTypes.func,
  setDropdownValue: PropTypes.func,
};
