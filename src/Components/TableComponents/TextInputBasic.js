import React from 'react';
import PropTypes from 'prop-types';
import {
  Flex,
  HelperText,
  HelperTextItem,
  Icon,
  TextInput,
  TextInputGroup,
  TextInputGroupMain,
} from '@patternfly/react-core';
import { CheckCircleIcon, InProgressIcon } from '@patternfly/react-icons';

export const TextInputBasic = ({
  hasWriteAccess,
  isLoading,
  isWriteAccessLoading,
  setTextValue,
  textValue,
  verifiedStatus,
}) => {
  return (
    <Flex direction={{ default: 'column' }}>
      <TextInputGroup>
        <TextInputGroupMain
          value={textValue}
          onChange={(_event, value) => setTextValue(value)}
        />
        <TextInput
          isDisabled={!isWriteAccessLoading && !hasWriteAccess}
          value={textValue}
          type="text"
          validated={!isLoading && verifiedStatus === 'error' && verifiedStatus}
          customIcon={
            (isLoading && <InProgressIcon />) ||
            (!isLoading && verifiedStatus === 'success' && (
              <Icon status="success">
                <CheckCircleIcon />
              </Icon>
            )) || <></>
          }
          onChange={(_event, value) => setTextValue(value)}
        />
      </TextInputGroup>
      {!isLoading && verifiedStatus === 'error' && (
        <HelperText>
          <HelperTextItem variant="error">
            There was an error saving the note.
          </HelperTextItem>
        </HelperText>
      )}
    </Flex>
  );
};

TextInputBasic.propTypes = {
  hasWriteAccess: PropTypes.bool,
  isLoading: PropTypes.string,
  isWriteAccessLoading: PropTypes.bool,
  setTextValue: PropTypes.func,
  textValue: PropTypes.string,
  verifiedStatus: PropTypes.string,
};
